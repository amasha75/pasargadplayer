!function(){"use strict";var O="googima",k="TYPE_API",_="TYPE_SCHEDULE",M="jw-flag-ads-googleima",C="jw-flag-ads-vpaid",R="jw-flag-ads-vpaid-controls",a="playing",q="adError",I="adItem",F="adStarted",i="viewable",n="external",S=n,T="instream",L="article",s=((t={})[[T]]=1,t[["banner"]]=2,t[[L]]=3,t[["feed"]]=4,t[["floating"]]=5,t[["interstitial"]]=5,t[["slider"]]=5,t);function U(){return(U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i,s=arguments[t];for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}var w="vast",x="googima",V="vmap",N="-1",l="cust_params=",B="adBreakIgnored",H="adError",j="__jwpseg__",D="instream",$="article",r=((t={})[[D]]=1,t[["banner"]]=2,t[[$]]=3,t[["feed"]]=4,t[["floating"]]=5,t[["interstitial"]]=5,t[["slider"]]=5,t),K=new RegExp(/^[^/]*:\/\/\/?([^/]*)/);var Y=new RegExp(/^[^:/?#]+:?\/\/[^/?#]+/),Z=/^(https?:\/\/).*.(?:ampproject.org|bing-amp.com)\/(?:.\/)*(.*)\/amp.*$/;function o(e){e=new RegExp("[?&]"+e+"=([^&]*)"),e=document.location.search.match(e);if(e)return decodeURIComponent(e[1])}function ee(t){return void 0===t&&(t=1e3),null===e&&(e=new Promise(function(i){var e=window.__tcfapi||te("__tcfapi");if(e)return e("getTCData",2,function(e,t){i(!1!==t?{gdprApplies:e.gdprApplies,consentData:e.tcString,addtlConsent:e.addtlConsent}:null)});e=window.__cmp||te("__cmp");if(e)return e("getConsentData",null,function(e,t){i(!1!==t?{gdprApplies:e.gdprApplies||e.isUserInEu,consentData:e.consentData}:null)});e=function(){if(o("isAMP")){var e=o("consentValue"),t=o("consentGdpr");if(e||t)return{gdprApplies:t,consentData:e}}}();return i(e||{gdprApplies:!1,consentData:""})}).then(function(e){return d=e?e:d})),Promise.race([e,new Promise(function(e){setTimeout(e,t,d)})])}var e=null,d={gdprApplies:!0,consentData:""},te=function(a){var o=function(e){for(var t=window;t;){try{if(t.frames[e])break}catch(e){}t=t===window.top?null:t.parent}return t}(a+"Locator");return null!==o&&function(e,t,s,i){var n,r=u(),i=(window.addEventListener("message",function e(t){t=t?t.data:{};if("string"==typeof t)try{t=JSON.parse(t)}catch(e){t={}}var i=a+"Return";t[i]&&t[i].callId===r&&(removeEventListener("message",e),s(t[i].returnValue,t[i].success))},!1),(n={})[[a+"Call"]]=((e={command:e,callId:r,parameter:i})[[void 0!==i?"version":"parameter"]]=t,e),n);o.postMessage(JSON.stringify(i),"*")}},u=Date.now||function(){return(new Date).getTime()};function P(e){e=e.advertising;if(e&&e.placement){var t=e.placement.toLowerCase();if(r[t])return r[t]}return r[e&&e.outstream?$:D]}function ie(){var e,t,i=null!==document.referrer.match(Y)?(i=(e=document.referrer).match(Z))&&1<i.length?""+i[1]+i[2]:e:"";if(window.top===window.self)return{url:document.location.href,domain:document.domain,referrer:i};try{return{url:window.top.location.href,domain:window.top.document.domain,referrer:i}}catch(e){}return{url:i,domain:(t=(t=i).match(K))&&1<t.length?t[1]:"",referrer:""}}function se(e,t){var i,s=e.getPlugin("inference"),n=t.jwpseg_client_side,r=t.jwpseg||[];if(!n||!n.length||!s)return r;try{i=s.predict(n,t)}catch(e){return t.jwpseg||[]}s=Object.keys(i).filter(function(e){return i[e]}),t=r.filter(function(e){return-1===n.indexOf(e)});return[].concat(s,t)}var ne=/^((https?:)?\/\/)?(secure)?pubads\.g\.doubleclick\.net\/gampad\/ads\?[\S]*$/;function h(s,e,t,i,n,r){if(void 0===r&&(r={}),!s)return Promise.resolve(s);u=t,h=(l=e).getConfig(),o=l.getPlaylistItem()===u;var a=U({playerHeight:l.getHeight()||h.height||"",playerWidth:l.getWidth()||h.width||"",itemDuration:o&&function(e,t){t=Math.pow(10,t);return Math.round(e*t)/t}(l.getDuration(),3)||"",item:u,jwpseg:se(l,u),placement:P(h),userAgent:navigator.userAgent},h.advertising?h.advertising.ampMacros:{}),o=ie();-1!==s.indexOf(j)&&(r.jwpseg=a.jwpseg),s=b(s,"__random-number__",Math.random()*Math.pow(10,18)),s=b(s,"__timestamp__",(new Date).getTime()),s=b(s,"__page-url__",encodeURIComponent(a.pageUrl||o.url)),s=b(s,"__referrer__",encodeURIComponent(a.referrer||o.referrer)),s=b(s,"__player-height__",a.playerHeight),s=b(s,"__player-width__",a.playerWidth),s=b(s,"__item-duration__",a.itemDuration),s=b(s,j,a.jwpseg),s=b(s,"__domain__",encodeURIComponent(a.domain||o.domain)),s=b(s,"__placement__",a.placement),s=b(s,"__device-ua__",encodeURIComponent(a.userAgent)),s=n.companion?b(s,"__companion-div__",n.companion.id):b(s,"__companion-div__","");for(var d,l,u,h,c=Object.keys(a).filter(function(e){return-1!==e.indexOf("item")}),g=c.map(function(e){e=e.match(/item([\w]+?)(List)?$/);if(e)return e[1].toLowerCase()}),p=/__item-([\w-]+?)(-list)?__/g,m=s;null!==(d=p.exec(m));){var f=d[0],y=d[1],v=c[g.indexOf(y)],A="";(t.hasOwnProperty(y)&&"string"==typeof t[y]||v)&&(A=v?a[v]:t[y],v=!1===n.truncateMacros?4096:1e3,A.length>v&&(A=A.substring(0,v)),y=d[2]?",":null,A=A.split(y).map(encodeURIComponent)),s=b(s,f,A)}return i===w&&(l=e.getConfig().autostart?1:0,u=e.getMute()?1:0,h=s,r=l,o=u,s=h=ne.test(h)?h+"&vpa="+r+"&vpmute="+o:h),i===x&&t.title&&-1===s.indexOf("vid_t=")&&(e=t.title.substring(0,100).replace(/[^\x00-\x7F]/g,""),s+=(-1!==s.indexOf("?")?"&":"?")+"vid_t="+encodeURIComponent(e)),-1!==s.indexOf("__gdpr__")||-1!==s.indexOf("__gdpr_consent__")||-1!==s.indexOf("__addtl_consent__")?ee().then(function(e){var t=e.gdprApplies,i=e.consentData,e=e.addtlConsent;return s=b(s,"__gdpr__",t?1:0),s=b(s,"__addtl_consent__",e||""),b(s,"__gdpr_consent__",i||"")}).catch(function(){return s}):Promise.resolve(s)}function b(e,t,i){return e.replace(t,i)}function re(){}function ae(e,t,i){if(W(e,"VMAP",V).length){var s=e,n=t,r=i,a=[],o=(G(W(s,"VMAP",V)[0],"version")||Q(a,"VMAP Schema Error: version missing from VMAP tag",N),W(s,"AdBreak",V));o.length||oe();for(var d,l,u,h,c,g,p=s.lookupNamespaceURI(V),m={},f=0;f<o.length;f++){var y={},v={},A=o[f],w=G(A,"timeOffset"),P=G(A,"breakId"),b=G(A,"breakType"),E=G(W(A,"AdSource",V)[0],"id"),k=W(A,"AdTagURI",V)[0],_=W(A,"VASTData",V)[0]||W(A,"VASTAdData",V)[0],M=G(k,"templateType"),k=de(k),C=(A=A,h="Tracking",c=V,void 0,g=[],(u=p)||A?g=A.getElementsByTagNameNS?A.getElementsByTagNameNS(u,h):A.getElementsByTagName(c+":"+h):g);if(b||Q(a,"VMAP Schema Error: missing breakType on AdBreak",P),_||M||Q(a,"VMAP Schema Error: missing templateType on AdBreak",P),w||Q(a,"VMAP Schema Error: missing timeOffset on AdBreak",P),y._type=b,y._vmap={id:E,breakid:P,timeoffset:w},_)y._adXML=(u=function(e,t){if(e){e=e.getElementsByTagName(t);if(e)return e[0]}return null}(_,"VAST")).ownerDocument instanceof Document?u.outerHTML||(new XMLSerializer).serializeToString(u):null;else{if("vast2"!==M&&"vast3"!==M&&"vast4"!==M)continue;y._adQueue=[k],y._waterfallIndex=0}var R=[];if(C)for(var I=0;I<C.length;I++){S=v,d=C[I],l=void 0,"progress"===(l=G(d,"event"))&&(l=l+"_"+G(d,"offset")),d=de(d),S[l]||(S[l]=[]),d&&(S[l].push(d),le(d));var S=G(C[I],"event");R.push(S)}(R.indexOf("breakStart")<0||R.indexOf("breakEnd")<0||R.indexOf("error")<0)&&Q(a,"Tracking events are missing breakStart, breakEnd, or error for AdBreak",P),y._trackers=v,y._type=b,w&&!m[w]?(m[w]=y,m[w]._pod=y._adQueue?[].concat(y._adQueue):[]):w&&m[w]&&y._adQueue&&(A=m[w]._pod).push.apply(A,y._adQueue)}return Object.keys(m).forEach(function(e){var t=m[e];switch(t._pod&&t._pod.length<=1&&delete t._pod,e){case"start":t._offSet="pre",n.setPreRoll(t);break;case"100%":case"end":t._offSet="post",n.setPostRoll(t);break;default:if(/^#/.test(e))break;/^\d\d?(?:\.\d+)?%$/.test(e)?t._offSet=e:t._offSet=r.seconds(e),n.addMidRoll(t)}}),n.preRoll||n.midRolls.length||n.postRoll||oe(),n.sort(null,!0),a}if(W(e,"Playlist",V).length){var T=t,L=i,s=W(e,"Playlist",V)[0],t=s.getElementsByTagName("Preroll")[0],i=s.getElementsByTagName("Postroll")[0],t=z(t,"pre"),i=z(i,"post");t&&T.setPreRoll(t),i&&T.setPostRoll(i);for(var x=s.getElementsByTagName("Midroll"),B=0;B<x.length;B++){var j=x[B],D=L.seconds(j.getAttribute("timeOffset")),j=z(j,D);T.addMidRoll(j)}return[]}throw new Error("No VMAP tag in response")}function z(e,t){if(!e)return null;var i=e.getElementsByTagName("Ad");if(!i.length)return null;var s={_offSet:t};if(1===i.length)s._adQueue=[i[0].textContent.trim()];else{s._pod=[];for(var n=0;n<i.length;n++)s._pod.push(i[n].textContent.trim())}return s}function Q(e,t,i){e.push({message:t,code:1002,adErrorCode:70001,id:i})}function oe(){var e=new Error("No AdBreaks in VMAP");throw e.adErrorCode=60005,e}function W(e,t,i){var s=[];return e&&(s=e.getElementsByTagName(t),i&&s&&0===s.length&&(s=e.getElementsByTagName(i+":"+t))),s}function G(e,t){return e?e.getAttribute(t):null}function de(e){if(e){e=e.textContent||e.text;if(e)return e.trim()}return""}var le=function(e){(0<=e.indexOf("[REGULATIONS]")||0<=e.indexOf("[GDPRCONSENT]"))&&(ee().catch(re),le=re)};function ue(e){e.onload=e.onreadystatechange=e.onerror=null,"abort"in e&&e.abort()}(t=ce.prototype).load=function(r,e,t,i){var a=this;if(this._vmapPromise)return this._vmapPromise;null!==this._vmapXHR&&(ue(this._vmapXHR),this._vmapXHR=null);e=h(this.getVMAP(),r,e,t,i);return this._vmapPromise=t===x?e.then(function(e){a.setPreRoll({_adQueue:[e]})}):e.then(function(s){return new Promise(function(e,n){a._vmapXHR=r.utils.ajax({url:s,withCredentials:i.withCredentials,retryWithoutCredentials:!0,requireValidXML:!0,timeout:a.requestTimeout},e,function(e,t,i,s){return n(s)})}).then(function(e){return a._vmapXHR=null,r.trigger("adLoadedXML",{client:t,tag:s,xml:e.responseXML}),ae(e.responseXML,a,r.utils).map(function(e){return U(e,{vmap:s})})}).catch(function(e){a._vmapXHR=null;var t,i={id:N,vmap:s};throw e.message?U(i,{message:"VMAP Schema Error: "+e.message,code:1002,adErrorCode:e.adErrorCode||11002}):(e=(t={1:{code:1007,message:"Timeout"},602:{code:1e3,message:"Invalid XML"},default:{code:1008,message:r.getConfig().localization.errors[e.key]}})[e.code]||t.default,r.utils.log(e.message),U(i,{message:"Error Loading VMAP Schedule",code:e.code,adErrorCode:e.code+1e4})),i})}),this._vmapPromise},t.canWaterfall=function(e){return e._adQueue&&e._waterfallIndex+1<e._adQueue.length},t.getPreRoll=function(e){return e&&"none"===this.adRules.startOnSeek?null:c(this.preRoll,this.requestTimeout,this.creativeTimeout)},t.getPostRoll=function(e){var t=c(this.postRoll,this.requestTimeout,this.creativeTimeout);return this.adRules.timeBetweenAdsAllowsAdPlayback(t,e)?t:null},t.getMidRollAtIndex=function(e){return c(this.midRolls[e],this.requestTimeout,this.creativeTimeout)},t.getLastMidRollIndexBetweenTime=function(e,t,i){if(t<e)return null;this.sort(i);for(var s=this.midRolls.length;s--;){var n=this.midRolls[s],r=g(this.midRolls[s]._offSet,i);if(r<=e)return null;if(r<=t){r=c(n,this.requestTimeout,this.creativeTimeout);if(!this.adRules.timeBetweenAdsAllowsAdPlayback(r))return null;if(!this.adRules.timeBetweenAds){if(0<=this.playedMidRolls.indexOf(s))return null;this.playedMidRolls.push(s)}return s}}return null},t.peek=function(e,t,i){if(this.midRolls.length>this.playedMidRolls.length){this.sort(i);for(var s=0;this.midRolls[s];){var n,r=g(this.midRolls[s]._offSet,i);if(e<=r&&-1===this.playedMidRolls.indexOf(s))return n=u()+1e3*(r-e),r<=t&&this.adRules.timeBetweenAdsAllowsAdPlayback(null,n)?s:null;s+=1}}var a=u()+1e3*(i-e);return this.postRoll&&i<=t&&this.adRules.timeBetweenAdsAllowsAdPlayback(null,a)?-1:null},t.getNextMidrollIndex=function(e,t,i){if(this.adRules.timeBetweenAds||this.adRules.startOnSeek)return this.getLastMidRollIndexBetweenTime(e,t,i);if(this.midRolls.length>this.playedMidRolls.length){e=this.getClosestIndex(t,i);if(0<=e&&this.playedMidRolls.indexOf(e)<0)return this.playedMidRolls.push(e),e}return null},t.getMidRolls=function(){var t=this;return this.midRolls.map(function(e){return c(e,t.requestTimeout,t.creativeTimeout)})},t.reset=function(){null!==this._vmapXHR&&(ue(this._vmapXHR),this._vmapXHR=null),this.playedMidRolls=[],this.duration=0},t.setPreRoll=function(e){this.resetBreakId(e),this.preRoll=e},t.addMidRoll=function(e){this.resetBreakId(e),this.midRolls.push(e),this.duration=0},t.setPostRoll=function(e){this.resetBreakId(e),this.postRoll=e},t.sort=function(i,e){if((!i||i<1)&&(i=1),this.duration!==i||e){this.duration=i,this.midRolls.sort(function(e,t){return g(e._offSet,i)-g(t._offSet,i)});for(var t=this.getAllAds(),s=e,n=0;n<t.length;n++){var r=t[n];s?r._vmap.item=n+1:(r._adbreak={item:n+1,breakid:r._breakId},r._pod?r._adbreak.pod=r._pod:r._adbreak.tags=r._adQueue)}}},t.getAllAds=function(){var e=this.preRoll?[this.preRoll]:[],t=this.postRoll?[this.postRoll]:[];return e.concat(this.midRolls,t)},t.setVMAP=function(e){this.vmap=e},t.isVMAP=function(){return!!this.vmap},t.getVMAP=function(){return this.vmap},t.getClosestIndex=function(e,t){this.sort(t);for(var i=this.midRolls.length;i--;)if(e>=g(this.midRolls[i]._offSet,t))return i;return-1},t.resetBreakId=function(e){e.adBreakId=this.utils.genId(12)},t.resetAllBreakIds=function(){var t=this;this.getAllAds().forEach(function(e){t.resetBreakId(e)})},t.destroy=function(){this.reset(),this.adRules.destroy()};var he=ce;function ce(e,t){this.adRules=e,this.utils=t,this.preRoll=null,this.vmap=null,this.postRoll=null,this.midRolls=[],this.playedMidRolls=[],this.duration=0,this._vmapPromise=null,this._vmapXHR=null}function c(i,e,t){var s;if(null!==i)return Object.keys(i).forEach(function(e){var t=i[e];(s=s||{})[e]="_adQueue"===e||"_pod"===e?t.slice():t}),s?(s.requestTimeout=e,s.creativeTimeout=t,s._errors=[],s._waterfallIndex=0,s._adPodIndex=0,s):void 0}function g(e,t){return"%"===e.toString().slice(-1)?t*parseFloat(e.slice(0,-1))/100:parseFloat(e)}(t=pe.prototype).getSchedule=function(e,t){var i,s,a,o,d,t=new he(t,this.utils);if(t.requestTimeout=p(e.requestTimeout,5e3),t.creativeTimeout=p(e.creativeTimeout,5e3),e.tag)t.setPreRoll({_offSet:"pre",_adQueue:me(e.tag),_waterfallIndex:0});else if("string"==typeof e.vastxml)t.setPreRoll({_offSet:"pre",_adXML:e.vastxml});else{if("string"==typeof e.schedule)return t.setVMAP(e.schedule),t;if("string"==typeof e.adschedule)return t.setVMAP(e.adschedule),t;i=t,s=e,a=this.utils,(d=s.schedule||s.adschedule)&&(o={},Object.keys(d).forEach(function(e){var t=d[e],i=(t.ad&&(U(t,t.ad),delete t.ad),function(e,t){if("start"===e||"0%"===e||!e&&0!==e)return"pre";if("end"===e||"100%"===e)return"post";if("pre"===e||"post"===e||0<=(e+"").indexOf("%"))return e;t=t.seconds(e);return"number"==typeof t&&t}(t.offset,a)),s=p(t.requestTimeout,5e3),n=p(t.creativeTimeout,5e3),r=o[i];if(r){if("nonlinear"===t.type)return;"nonlinear"===r._type&&(r=null)}r=o[i]=r||{_offSet:i,_type:t.type,_breakId:e,adBreakId:a.genId(12),requestTimeout:s,creativeTimeout:n},!1===i&&a.log("Error: ad offset format not supported",i),e=t.skipoffset;void 0!==e&&void 0===r.skipoffset&&(r.skipoffset=e),"string"==typeof t.adm?r.adm=t.adm:t.pod?(s=r._pod||[],r._pod=s.concat(t.pod)):t.tag?(n=function(e,i){if(!i)return e;var t,s=0<=e.indexOf("?")?"&":"?",n=e.indexOf(l),r=l.length,a="",o="";return Object.keys(i).forEach(function(e){var t=i[e];a=""+a+o+e+"="+t,o="&"}),a=encodeURIComponent(a),0<=n?(t=e.substr(0,n+r),n=e.substr(n+r),""+t+a+"%26"+n):e+s+l+a}(t.tag,t.custParams),r._adQueue&&(r._pod=[r._adQueue[0]],delete r._adQueue),r._pod?r._pod.push(me(n)[0]):r._adQueue=me(n)):"string"!=typeof t.vastxml?a.log("Error: no ad tag provided"):r._adXML=t.vastxml}),Object.keys(o).forEach(function(e){var t=o[e];switch(t.skipoffset=(void 0!==t.skipoffset?t:s).skipoffset,e){case"pre":i.setPreRoll(t);break;case"post":i.setPostRoll(t);break;default:i.addMidRoll(t)}}))}return t.sort(),t},t.getOptParams=function(e,t){t={cuetext:t.cuetext,dynamicMessage:t.admessage,loadingAd:t.loadingAd,podMessage:t.podmessage,skipoffset:e.skipoffset,skipMessage:t.skipmessage,skipText:t.skiptext,omidAccessMode:e.omidAccessMode||"full",omidSupport:e.omidSupport||"auto",allowedOmidVendors:e.allowedOmidVendors||[],vpaidcontrols:e.vpaidcontrols||!1,conditionaladoptout:e.conditionaladoptout||!1,requestFilter:e.requestFilter,trackingFilter:e.trackingFilter,withCredentials:void 0===e.withCredentials||e.withCredentials},e=e.companiondiv;return e&&(t.companion={id:e.id,height:e.height,width:e.width}),t},t.getAdRules=function(e){var e=e.rules||{},t=parseInt(e.frequency,10);return{startOn:e.startOn||1,frequency:isNaN(t)?1:t,timeBetweenAds:e.timeBetweenAds||0,startOnSeek:e.startOnSeek||null,deferAds:e.deferAds||null}};var ge=pe;function pe(e){this.utils=e}function me(e){return Array.isArray(e)?e.slice(0):[e]}function p(e,t){return 0===e?1/0:e||t}function fe(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function ye(e,t,i){void 0===t&&(t=null),void 0===i&&(i={});var s={client:e.client},n=e.bidding,r=e.item,a=e.player;return e.isDestroyed()||U(s,{placement:P(a.getConfig()),viewable:a.getViewable()}),i.jwpseg&&(s.jwpseg=i.jwpseg),t&&(U(s,{adBreakId:(a=e.getAdIds(t,i)).adBreakId,adPlayId:e=a.adPlayId,offset:t._offSet}),n&&(i=n.getBid(e))&&U(s,i.getEventObject())),s.item=r,s}function ve(e,t,i,s){return{client:s,message:e,adErrorCode:t,id:N,placement:P(i),tag:""}}function Ae(){}(t=ke.prototype).shouldDeferAds=function(){return this.options.deferAds&&!this.player.getConfig().activeTab},t.clearStartOnSeek=function(){this.ignoreStartOnSeek=!0},t.sendAdBreakIgnored=function(e,t){var i;e&&this.player.trigger(B,(this.client,i={},U(i=e?{id:e._breakId,tag:e._adQueue&&0<e._adQueue.length?e._adQueue[0]:e._adXML,offset:e._offSet}:i,{timeSinceLastAd:t,type:B})))},t.rulesAllowAdPlayback=function(e){var t=this.options,i=0===t.frequency&&1===e,e=e>=t.startOn&&(e-t.startOn)%t.frequency==0;return i||e},t.handleAdBreakStart=function(){this.adSkipped=!1,this.adComplete=!1},t.handleAdComplete=function(){this.adComplete=!0},t.handleAdSkipped=function(){this.adSkipped=!0},t.handleAdBreakEnd=function(){!this.adSkipped&&this.adComplete&&(this.recentCompletedAdTime=u())},t.timeBetweenAdsAllowsAdPlayback=function(e,t){if(void 0===t&&(t=u()),this.options.timeBetweenAds){t=(t-this.recentCompletedAdTime)/1e3;if(t<this.options.timeBetweenAds)return this.sendAdBreakIgnored(e,t),!1}return!0},t.reset=function(){this.ignoreStartOnSeek=!1,this.recentCompletedAdTime=0},t.destroy=function(){this.player.off(null,null,this)},fe((t=ke).prototype,[{key:"timeBetweenAds",get:function(){return this.options.timeBetweenAds}},{key:"startOnSeek",get:function(){return this.ignoreStartOnSeek?null:this.options.startOnSeek}}]),Object.defineProperty(t,"prototype",{writable:!1});var we=ke,Pe=((t=Ee.prototype).getAdRules=function(){return this.adRules},t.resetDefaultSchedule=function(e){var t=void 0===this.pluginConfig.withCredentials||this.pluginConfig.withCredentials,i=this.defaultSchedule=this.configParser.getSchedule(this.pluginConfig,this.adRules);i.isVMAP()&&i.load(this.player,e,this.adClient,{withCredentials:t}).catch(Ae)},t.getSchedule=function(e,t){return 0<t&&!this.adRules.rulesAllowAdPlayback(t)?this.emptySchedule:e&&e.adschedule?this.configParser.getSchedule(e,this.adRules):(this.resetDefaultSchedule(e),this.defaultSchedule)},t.getOptParams=function(e,t){return this.configParser.getOptParams(e,t)},t.reset=function(){this.adRules.reset()},t.destroy=function(){this.emptySchedule&&this.emptySchedule.destroy(),this.defaultSchedule&&this.defaultSchedule.destroy()},Ee),be={adPosition:"",autoplayadsmuted:!1,companiondiv:null,companionResourceType:"",customUi:null,debug:!1,omidSupport:"disabled",omidAccessModeRules:{},enablePreloading:!1,loadVideoTimeout:15e3,locale:"",maxRedirects:-1,ppid:"",preloadAds:!1,requestTimeout:1e4,truncateMacros:!0,vastLoadTimeout:1e4,vpaidcontrols:!1,vpaidmode:"insecure"};function Ee(e,t,i){this.player=e,this.pluginConfig=t,this.adClient=i;var s=this.configParser=new ge(e.utils),s=this.adRules=new we(e,s.getAdRules(t),i);this.emptySchedule=new he(s,e.utils)}function ke(e,t){this.player=e,this.options=t,this.client=t.client,this.ignoreStartOnSeek=!1,this.reset(),t.timeBetweenAds&&e.on({adBreakStart:this.handleAdBreakStart,adSkipped:this.handleAdSkipped,adComplete:this.handleAdComplete,adBreakEnd:this.handleAdBreakEnd,destroyPlugin:this.destroy},this)}Re.prototype.setLocalizationOptions=function(e){var t=e.admessage,i=e.cuetext,s=e.podmessage,n=e.loadingAd,r=e.skipmessage,e=e.skiptext;this.admessage=t,this.cuetext=i,this.loadingAd=n,this.podmessage=s,this.skipmessage=r,this.skiptext=e};var _e=Re,Me=((t=Ce.prototype).resizeNonLinear=function(e){this.resize(!1,e)},t.resizeLinear=function(){this.resize(!0)},t.resize=function(e,t){var i=this.utils;i.toggleClass(this.div,"jw-ad-non-linear",!e),i.toggleClass(this.div,"jw-ad-linear",e),i.style(this.div,{height:t?t+"px":""})},t.getAdDiv=function(){return this.adDiv},t.adSetup=function(){this.visible=!0,this.utils.addClass(this.div,"jw-ad-instream"),this.resize(!0)},t.adTakeDown=function(){this.visible=!1,this.utils.removeClass(this.div,"jw-ad-instream"),this.resize(!0)},Ce),m=null;function Ce(e,t,i){i.addClass(e,"jw-plugin-googima");var s=document.createElement("div");s.id=t+"_ad",s.className="jw-ads-view",this.visible=!1,this.utils=i,this.div=e,this.adDiv=s,e.appendChild(s)}function Re(e,t){for(var i in this.config=e,this.utils=t,this.bidsResponse={},be)if(be.hasOwnProperty(i)){var s=e[i],n=be[i],r=typeof n;if(void 0!==s){if(typeof(s="boolean"!=r&&"number"!=r?s:function(e){if("true"===e)return!0;if("false"===e)return!1;var t=parseFloat(e);return isNaN(t)?e:t}(s))!=r)throw new Error("invalid parameter: "+i+" should be a "+r);this[i]=s}else this[i]=n}}function X(e){if(m)return m;if(window.google&&google.ima&&google.ima.AdDisplayContainer)return m=Promise.resolve();var t=["//","imasdk.googleapis.com/js/sdkloader/ima3_debug.js"],e=("file:"===document.location.protocol&&t.unshift("https:"),new e.scriptloader(t.join("")));return m=e.load()}(t=Se.prototype).setProxy=function(e){this.imaProxy=e,"boolean"==typeof this.muted&&this.mute(this.muted)},t.attachMedia=function(){},t.detachMedia=function(){},t.mute=function(e){this.muted=e,this.imaProxy&&(e?this.imaProxy.setVolume(0):this.vol&&this.imaProxy.setVolume(this.vol)),this.muteAllAdContainerVideo(e)},t.muteAllAdContainerVideo=function(e){for(var t=this.view.getAdDiv().getElementsByTagName("video"),i=0;i<t.length;i++)t[i].muted=e},t.volume=function(e){this.vol=e/100,this.imaProxy&&this.imaProxy.setVolume(this.vol)};var Ie=Se;function Se(e,t,i){e.extend(this,t),this.vol=0,this.imaProxy=null,this.view=i}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(){}(t=Le.prototype).attachListeners=function(){this.player.on({all:this.onAll,beforePlay:this.checkPreroll,relatedReady:this.relatedReady,cast:this.onCast,destroyBidding:this.destroyBids},this)},t.onAll=function(e,t){"time"===e?this.checkMidrolls(t):"beforeComplete"===e&&this.checkPostrolls(t)},t.relatedReady=function(){var e,t=this;this.config.preloadAds&&(e=this.player.getPlugin("related"))&&e.on("nextUp",function(e){e&&"discovery"===e.mode&&(t.relatedNextUp=e)})},t.onCast=function(e){this.casting=!!e.active},t.init=function(t,i){var e,s=this;return void 0===t&&(t=null),this.schedule.isVMAP()&&(i.requestTimeout=this.schedule.requestTimeout,i.creativeTimeout=this.schedule.creativeTimeout,this.vmapPromise=this.schedule.load(this.player,this.item,this.client,i)),this.bidsPromise=this.vmapPromise||Promise.resolve(),this.bidsPromise=(null!==t?this.bidsPromise.then(function(){if(!s.isDestroyed()){if(s.bidding)return s.createBidsPromise(t,i);U(e=ye(s,null,i),{message:"Ad Error: bidding plugin unavailable",code:900,adErrorCode:60008});s.player.trigger(H,e)}var e}):this.bidsPromise).catch(f),this.config.preloadAds&&(1===i.playlistItemEventCount?!1===(e=this.player.getConfig().autostart)||"viewable"===e&&0===this.player.getViewable()?this.loadPreroll(i).catch(function(e){return s.isDestroyed()?null:s.enqueueAdEvent(H,e,{preload:!0})}):this.player.once("autostartNotAllowed",function(){s.loadPreroll(i).catch(function(e){return s.isDestroyed()?null:s.enqueueAdEvent(H,e,{preload:!0})})}):i.preloadPreroll&&this.loadPreroll(i).catch(function(e){return s.isDestroyed()?null:s.enqueueAdEvent(H,e,{preload:!0})})),this.bidsPromise},t.createBidsPromise=function(a,o){var d=this,l=this.player,e=0<(e=parseInt(a.bidOnBreaks,10))?e:1/0;return this.bids=this.schedule.getAllAds().slice(0,e).map(function(i){var e=d.getAdIds(i).adPlayId,t=l.getConfig(),s=d.config.skipoffset,n=null!=s&&0<=s,r=se(l,d.item),e={id:e,offset:a.offset,jwpseg:r,placement:P(t),tag:i._adQueue?i._adQueue[0]:i._currentTag,adClient:d.client},t=(d.client===w&&(e.skipoffset=n?s:-1),d.bidding.createNewBid(e,{getURLParts:ie})),n=(d.player.trigger("adBidRequest",ye(d,i,U({jwpseg:r},o))),t.init(),t.start().then(function(e){var t,e=e.result;if(!d.isDestroyed())return t=Promise.resolve(),e&&!e.error&&(i.jwpseg=r,e.adm?(i._adXML=e.adm,i._adQueue&&i._adQueue.length&&i._adQueue.unshift(e.adm)):e.tag&&(t=h(e.tag,d.player,d.item,d.client,{},i).then(function(e){d.client===w?(i._adQueue=i._adQueue||[],i._adQueue.unshift(e)):i._adQueue=[e]}))),d.player.trigger("adBidResponse",ye(d,i,o)),t}));return d.bidsPromises.push(n),t}),Promise.all(this.bidsPromises)},t.checkPreroll=function(e){var t,i,s=this;this.bidTimeoutStarted||(this.bidTimeoutStarted=!0,this.bids.forEach(function(e){return e.timeout()})),this.casting||this.preRollPlayed||this.adRules.shouldDeferAds()||(this.preRollPlayed=!0,t=(e||{}).startTime||this.player.getPosition(),this.lastTimeEvent=t||this.lastTimeEvent,((i=this.schedule.getPreRoll(t))||this.vmapPromise)&&((null!==this.vmapPromise||i&&"nonlinear"!==i._type)&&this.startBlocking(),this.bidsPromise.then(function(){var e;s.isDestroyed()||(e=s.schedule.getPreRoll(t))&&"nonlinear"!==e._type&&s.triggerAdBreakEvents(e,"pre")}),t?"none"===this.adRules.startOnSeek&&(this.prerollPromise=null):this.adRules.clearStartOnSeek(),i=e&&e.playReason?e.playReason:"external",this.playPreroll({adBlock:this.adBlockErrorDetected,startTime:t,reason:i})))},t.checkMidrolls=function(e){var t,i,s,n,r=this;this.casting||0===e.duration||this.adRules.shouldDeferAds()||(s=this.schedule.getNextMidrollIndex(this.lastTimeEvent,e.position,e.duration),this.lastTimeEvent=e.position,null!==s?("nonlinear"!==(t=this.schedule.getMidRollAtIndex(s))._type&&(this.startBlocking(),this.triggerAdBreakEvents(t,"mid")),this.playMidrollAtIndex(s,{adBlock:this.adBlockErrorDetected})):!this.preRollPlayed&&this.schedule.getClosestIndex(e.position,e.duration)<0?this.checkPreroll(e):this.config.preloadAds&&(t=e.position+5,null!==(s=this.schedule.peek(e.position,t,e.duration))&&0<=s?this.loadMidrollAtIndex(s,{adBlock:this.adBlockErrorDetected,preload:!0}).catch(f):-1===s?(s=u()+1e3*(e.duration-e.position),this.loadPostroll({adBlock:this.adBlockErrorDetected,preload:!0,startTime:s}).catch(f)):null===this.next&&null===this.nextPlaylistItemPromise&&t>e.duration&&(i=this.player.getPlaylistIndex()+1,s=this.player.getPlaylistItem(i),this.nextPlaylistRelated=!!this.relatedNextUp,(s||this.relatedNextUp)&&(n=this.relatedNextUp?-1:i,this.nextPlaylistItemPromise=Promise.resolve(this.player.getPlaylistItemPromise(n)).then(function(){r.isDestroyed()||(r.trigger("preloadNext",{item:r.player.getPlaylistItem(i)||r.relatedNextUp,index:n}),r.relatedNextUp=null,r.nextPlaylistItemPromise=null)}).catch(f)))))},t.checkPostrolls=function(e){var t;this.casting||this.adRules.shouldDeferAds()||this.isDestroyed()||(t=this.schedule.getPostRoll())&&("nonlinear"!==t._type&&(this.startBlocking(),this.triggerAdBreakEvents(t,"post")),this.playPostroll(e))},t.getAdIds=function(e,t){var t=void 0===t?{}:t,i=t.tagIndex,t=t.podIndex,i=e.adRequestIds&&void 0!==i?e.adRequestIds[i]:null;return i||(i="p0w0"==(t="p"+(t||e._adPodIndex||0)+"w"+(e._waterfallIndex||0))?e.adBreakId:(e.adPlayIds=e.adPlayIds||{},e.adPlayIds[t]=e.adPlayIds[t]||this.player.utils.genId(12))),{adBreakId:e.adBreakId,adPlayId:i}},t.loadPreroll=function(t){var i=this;return void 0===t&&(t={}),this.prerollPromise||(this.prerollPromise=this.bidsPromise.then(function(){var e;if(!i.isDestroyed())return(e=i.schedule.getPreRoll(t.startTime))?(e._position="pre",e._preload=!0,i.loadAd(e,t)):void 0})),this.prerollPromise},t.loadMidrollAtIndex=function(t,i){var s=this;return this.midrollPromise[t]||(this.midrollPromise[t]=this.bidsPromise.then(function(){var e;if(!s.isDestroyed())return(e=s.schedule.getMidRollAtIndex(t))?(e._position="mid",e._preload=!0,s.loadAd(e,i)):void 0})),this.midrollPromise[t]},t.loadPostroll=function(t){var i=this;return void 0===t&&(t={}),this.postrollPromise||(this.postrollPromise=this.bidsPromise.then(function(){var e;if(!i.isDestroyed())return(e=i.schedule.getPostRoll(t.startTime))?(e._position="post",e._preload=!0,i.loadAd(e,t)):void 0})),this.postrollPromise},t.playPreroll=function(t){var i=this;this.prerollPromise?this.playPreloadedPromise(this.prerollPromise,t):this.bidsPromise.then(function(){var e;i.isDestroyed()||((e=i.schedule.getPreRoll(t.startTime))?(e._position="pre",i.startAdBreak(e,t)):i.stopBlocking())})},t.playMidrollAtIndex=function(t){var i=this;this.midrollPromise[t]?this.playPreloadedPromise(this.midrollPromise[t]):this.bidsPromise.then(function(){var e=i.schedule.getMidRollAtIndex(t);e&&(e._position="mid",i.startAdBreak(e))})},t.playPostroll=function(t){var i=this;this.postrollPromise?this.playPreloadedPromise(this.postrollPromise):this.bidsPromise.then(function(){var e=i.schedule.getPostRoll();e&&(e._position="post",i.startAdBreak(e,t))})},t.isDestroyed=function(){return null===this.player},t.destroy=function(){this.destroyBids(),this.player.off(null,null,this),this.player=null},t.destroyBids=function(){this.bids.forEach(function(e){return e.stop()}),this.bidsPromises=[],this.bids=[]},t.enqueueAdEvent=function(e,t,i){this._events.push({type:e,event:t}),i.preload||this.dequeueAdEvents()},t.dequeueAdEvents=function(){},t.triggerAdBreakEvents=function(){},t.startBlocking=function(){},t.stopBlocking=function(){},t.loadAd=function(){},t.playPreloadedPromise=function(){},t.startAdBreak=function(){};var t=Le;function Le(e,t,i,s,n){U(this,e.Events),this.client="shared",this.player=e,this.item=i,this.config=s,this.casting=n;i=e.utils,n=new ge(i);this.adRules=new we(e,n.getAdRules(s)),"string"==typeof t?(this.schedule=new he(this.adRules,i),this.schedule.setPreRoll({tag:t})):(this.schedule=t).resetAllBreakIds(),this.vmapPromise=null,this.lastTimeEvent=null,this.prerollPromise=null,this.midrollPromise={},this.postrollPromise=null,this.next=null,this.nextPlaylistItemPromise=null,this.relatedNextUp=null,this.bidding=e.getPlugin("bidding"),this.bids=[],this.bidsPromises=[],this.bidsPromise=null,this._events=[]}function xe(e){e=e.advertising;if(e&&e.placement){var t=e.placement.toLowerCase();if(s[t])return s[t]}return s[e&&e.outstream?L:T]}function Be(e,t){e=function(e,t){if("start"===e||"0%"===e)return"pre";if("end"===e||"100%"===e)return"post";if("string"==typeof e&&("pre"===e||"post"===e||0<=e.indexOf("%")))return e;t=t.seconds(e);return"number"==typeof t&&!isNaN(t)&&t}(e,t);return"pre"===e?0:"post"===e?-1:e}function y(e,t){if(e&&e[t]&&"function"==typeof e[t])try{for(var i=arguments.length,s=new Array(2<i?i-2:0),n=2;n<i;n++)s[n-2]=arguments[n];return e[t].apply(e,s)}catch(e){return null}return null}function je(e,t,i,s,n){i=J(e,i,s,n),s=t.getVastErrorCode?t.getVastErrorCode():t.code,n=(n=t.getErrorCode?t.getErrorCode():t.adErrorCode)<1e4?n+2e4:n||60900;return U(i,{message:"Ad Error: "+(t.getMessage?t.getMessage():t.message),code:100<=s&&s<=1008?s:900,adErrorCode:n}),e&&(20402===n?i.timeout=e.options.loadVideoTimeout:21009===n?i.timeout=e.options.vastLoadTimeout:60004===n&&(i.timeout=e.options.requestTimeout)),void 0!==t.placement&&(i.placement=t.placement),void 0!==t.id&&(i.id=t.id),t.getInnerError&&(i.sourceError=t.getInnerError()),void 0!==t.tag&&(i.tag=t.tag),i}function J(e,t,i,s){void 0===t&&(t=null),void 0===s&&(s={});var n={client:O};if(!e)return n;var r,a=e.bidding,o=e.config,d=e.player,d=(U(n,{placement:xe(d.getConfig()),viewable:d.getViewable()}),s.jwpseg&&(n.jwpseg=s.jwpseg),o.preloadAds&&(n.preloadAds=s.preload||i&&i._preload||!1),y(t,"getAdPodInfo")),d=(d&&(1<(o=y(d,"getTotalAds"))&&(U(n,{sequence:r=y(d,"getAdPosition"),podcount:o}),s.podIndex="number"==typeof r?r-1:0),void 0===n.adposition&&(o=y(d,"getTimeOffset"),n.adposition=0===o?"pre":-1===o?"post":"mid")),i&&(d=(r=e.getAdIds(i,s)).adBreakId,o=r.adPlayId,U(n,{tag:i._adQueue&&0<i._adQueue.length?i._adQueue[0]:i._adXML||i.adm,adBreakId:d,adPlayId:o,id:d,adposition:i._position}),i.jwpseg&&(n.jwpseg=i.jwpseg),a&&(r=a.getBid(o))&&U(n,r.getEventObject())),e.adsLoaderManager||s.loader);return t&&(d&&("dfp"!==(i=n.mediationLayerAdServer)&&"jwpdfp"!==i||-1!==(y(t,"getWrapperAdSystem")||[]).concat(y(t,"getAdSystem")||[]).indexOf("SpotXJW")&&n.bidders.forEach(function(e){e.winner="SpotX"===e.name}),a=d.userRequestContext,U(n,{tag:n.tag||d.getTag(t),ima:{ad:t,userRequestContext:a}})),U(n,{adtitle:t.getTitle(),adsystem:t.getAdSystem(),creativetype:t.getContentType(),duration:t.getDuration(),linear:t.isLinear()?"linear":"nonlinear",description:t.getDescription(),creativeAdId:t.getCreativeAdId(),adId:t.getAdId(),universalAdId:t.getUniversalAdIds().map(function(e){return{universalAdIdRegistry:e.g,universalAdIdValue:e.h}}),advertiser:t.getAdvertiserName(),dealId:t.getDealId()}),(o=t.getMediaUrl())&&(n.mediaFile={file:o})),void 0!==s.offset&&U(n,{adposition:n.adposition||s.offset,offset:s.offset}),n}function De(e){return e.isBeforePlay()||0===e.getPosition()?"pre":e.isBeforeComplete()||e.getPosition()===e.getDuration()?"post":"mid"}function v(){return null}(E=We.prototype).time=function(e){this.playbackProxy.currentTime=e.position,e.duration>=e.position?this.playbackProxy.duration=e.duration:this.playbackProxy.duration=1/0},E.init=function(e,n,i){var r=this,a=(this.requestType=e,this.requestOptions=n,this.scheduledAd=i,this.offset=i._offset,this.adsLoaderManager);return this.initAdsManagerPromise=this.initAdsManagerPromise||X().then(function(){return r.destroyed()?null:(r.debugConsoleLog("[JW DEBUG] Open adsLoaderManager"),a.open(e,n,r.video))}).then(function(e){if(r.destroyed())return null;var t,i,e=a.getAdsManager(e,r.playbackProxy,r.options),s=(r.instreamProvider.setProxy(e),a.bindEvents({AD_ERROR:r.adError.bind(r),LOADED:r.adLoaded.bind(r),CONTENT_PAUSE_REQUESTED:r.pauseRequested.bind(r),CONTENT_RESUME_REQUESTED:r.resumeRequested.bind(r),LOG:r.adLog.bind(r),STARTED:r.adStarted.bind(r),IMPRESSION:r.adImpression.bind(r),LINEAR_CHANGED:r.resize.bind(r),CLICK:r.adClick.bind(r),PAUSED:r.adPaused.bind(r),RESUMED:r.adResumed.bind(r),SKIPPED:r.adSkipped.bind(r),USER_CLOSE:r.adUserClose.bind(r),ALL_ADS_COMPLETED:r.allAdsCompleted.bind(r)},r),n.preloadAds?clearTimeout(r.timeoutAdStart):(s=(i=r.player.getSafeRegion(!1)).width,i=i.height,t=r.getViewMode(),r.debugConsoleLog("[JW DEBUG] adsManager init with",s,i,t),a.init(s,i,t)),e.getCuePoints());return s.length&&(i=s.filter(function(e){return 0<e}).map(function(e){return{begin:e,text:r.options.cuetext,cueType:"ads"}}),r.player.addCues(i)),e}).catch(function(e){var t;if(clearTimeout(r.timeoutAdStart),r.asyncError&&!i._preload&&r.asyncError(e),e&&e.getError)throw t=e.getError(),r.getAdErrorEventObject(t,e);throw e}),this.initAdsManagerPromise},E.getViewMode=function(){var e=google.ima.ViewMode;return this.player.getFullscreen()?e.FULLSCREEN:e.NORMAL},E.beforeComplete=function(){var e=this.adsLoaderManager.adsManager;e&&-1<e.getCuePoints().indexOf(-1)&&this.playlistItemManager.startBlocking(),this.adsLoaderManager.unbindEvents(["CONTENT_RESUME_REQUESTED"]),this.debugConsoleLog("[JW DEBUG] Call contentComplete on IMA SDK"),this.adsLoaderManager.contentComplete()},E.requestAds=function(){var e,t,i=this;if(!this.destroyed())return this.debugConsoleLog("[JW DEBUG] Request ads to IMA SDK"),t=Promise.resolve(),this.scheduledAd._adQueue&&this.scheduledAd._adQueue.length&&(e=this.scheduledAd._adQueue.map(function(e,t){return h(e,i.player,i.item,i.client,i.options,i.scheduledAd).then(function(e){i.scheduledAd._adQueue[t]=e})}),t=Promise.all(e)),t.then(function(){i.startRequestTimeout(),i.trigger("adRequest",J(i.playlistItemManager,null,i.scheduledAd)),i.adsLoaderManager.requestAds(i.requestType,i.requestOptions,i.options,i.scheduledAd)})},E.muteInstreamProvider=function(){var e=this.video.muted||this.player.getMute();this.debugConsoleLog("[JW DEBUG] Setting mute on instreamProvider",e),this.instreamProvider.mute(e)},E.pauseRequested=function(e){var t=this.playlistItemManager.schedule.isVMAP(),e=(t&&this.playlistItemManager.startBlocking(),e&&e.getAd()),t=(t&&(t=y(e,"getAdPodInfo"),(t=y(t,"getTimeOffset"))&&(this.scheduledAd._position=t=-1===t?"post":"mid",this.playlistItemManager.triggerAdBreakEvents(this.scheduledAd,t))),J(this.playlistItemManager,e,this.scheduledAd));this.trigger(I,t)},E.resumeRequested=function(){this.debugConsoleLog("[JW DEBUG] ResumeRequest from IMA SDK"),this.currentAd&&this.currentAd.isLinear()&&this.finishAd(),this.blockingInstreamPlayer&&this.view.adTakeDown(),this.trigger("stopBlocking"),this.blockingInstreamPlayer=null},E.finishAd=function(){this.currentAd&&(this.hideCustomUi(),clearInterval(this.progressIntervalId),this.viewablePlayedTime=0,this.currentAd=null)},E.discardAdBreak=function(e){!e&&this.adsLoaderManager&&(e=this.adsLoaderManager.adsManager),!this.destroyed()&&e&&(0===e.getCuePoints().length?this.destroy():(e.discardAdBreak(),e.stop()))},E.asyncDiscardAdBreak=function(){var t=this;this.initAdsManagerPromise&&this.initAdsManagerPromise.then(function(e){return t.discardAdBreak(e)}).catch(v)},E.pause=function(e){var t,e=e.reason;this.destroyed()||(t=this.adsLoaderManager.adsManager)&&(this.viewablePlayedTime=0,this.debugConsoleLog("[JW DEBUG] JW Player pause ad"),this.reason=e||n,t.pause())},E.resume=function(e){var t,e=e.reason;this.destroyed()||(t=this.adsLoaderManager.adsManager)&&(this.debugConsoleLog("[JW DEBUG] JW Player resume ad"),this.reason=e||n,t.resume())},E.startRequestTimeout=function(){var e=this;clearTimeout(this.timeoutAdStart),this.timeoutAdStart=setTimeout(function(){e.debugConsoleLog("[JW DEBUG] Ad request timeout"),e.destroyed()||(e.asyncError=null,e.handleAdError({message:"Ad Request timeout after "+e.options.requestTimeout+" milliseconds",getErrorCode:function(){return 60004}}),e.asyncDiscardAdBreak())},this.options.requestTimeout)},E.startAdsLoader=function(e){var n=this;if(this.destroyed()||!this.initAdsManagerPromise)return Promise.reject();this.player.off("beforePlay",null,this),e&&(this.blockingInstreamPlayer=e).setText(this.options.loadingAd),this.muteInstreamProvider(),this._qoe.tick("adBeforePlay"),this.startRequestTimeout(),this.initAdsManagerPromise.then(function(){var e,t,i,s;n.destroyed()||((e=n.adsLoaderManager).initialized||(t=(i=n.player.getSafeRegion(!1)).width,i=i.height,s=n.getViewMode(),n.debugConsoleLog("[JW DEBUG] adsManager init with",t,i,s),e.init(t,i,s)),n.debugConsoleLog("[JW DEBUG] Start adsManager"),e.start())}).catch(v)},E.resize=function(){var e,t,i=this.currentAd,s=this.adsLoaderManager.adsManager;s&&(t=i&&!i.isLinear(),e=this.player.getSafeRegion(t),t?(t=i.getHeight(),t=this.player.getFullscreen()?e.height/2:Math.max(100,t+10),this.debugConsoleLog("[JW DEBUG] Resize adsManager",e.width,t,this.getViewMode()),s.resize(e.width,t,this.getViewMode()),this.view.resizeNonLinear(t)):(this.debugConsoleLog("[JW DEBUG] Resize adsManager",e.width,e.height,this.getViewMode()),s.resize(e.width,e.height,this.getViewMode()),this.view.resizeLinear()))},E.setState=function(e,t,i){e.isLinear()&&((e=J(this.playlistItemManager,e,this.scheduledAd)).newstate=t,i&&(e.oldstate=i),null!==this.reason&&(e[t===a?"playReason":"pauseReason"]=this.reason,this.reason=null),this.instreamProvider.trigger("state",e))},E.customMainClickHandler=function(){this.adsLoaderManager.adsManager.resume()},E.customSkipHandler=function(e){e.stopPropagation(),this.timeTillSkip<=0&&this.adsLoaderManager.adsManager.skip()},E.customClickHandler=function(e){e.stopPropagation(),this.adsLoaderManager.adsManager.clicked()},E.addCustomEventHandlers=function(){this.mainClick=this.customMainClickHandler.bind(this),this.customSkip=this.customSkipHandler.bind(this),this.customClick=this.customClickHandler.bind(this),this.mainContainer.addEventListener("click",this.mainClick),this.adClickButton&&this.adClickButton.addEventListener("click",this.customClick),this.customSkipButton&&this.customSkipButton.addEventListener("click",this.customSkip)},E.removeCustomEventHandlers=function(){this.mainContainer.removeEventListener("click",this.mainClick),this.adClickButton&&this.adClickButton.removeEventListener("click",this.customClick),this.customSkipButton&&this.customSkipButton.removeEventListener("click",this.customSkip)},E.showCustomUi=function(){this.customUiDiv&&(this.customUiDiv.style.display="block",this.addCustomEventHandlers())},E.hideCustomUi=function(){this.customUiDiv&&(this.customUiDiv.style.display="none",this.removeCustomEventHandlers())},E.adLoaded=function(e){clearTimeout(this.timeoutAdStart);var e=e.getAd(),t=(this.playlistItemManager.schedule.isVMAP()&&(t=y(e,"getAdPodInfo"),(t=y(t,"getTimeOffset"))&&(this.scheduledAd._position=-1===t?"post":"mid")),J(this.playlistItemManager,e,this.scheduledAd));this.trigger("adLoaded",t)},E.adStarted=function(e){this.player.getPip()&&this.player.requestPip(this.view.getAdDiv().querySelector("video"));e=e.getAd(),this.currentAd=e,this.paused=!1,e.isUiDisabled()&&this.showCustomUi(),e=J(this.playlistItemManager,e,this.scheduledAd);this.trigger(F,e)},E.adImpression=function(e){var t=this,e=(this.view.adSetup(),e.getAd()),i=e.isLinear(),s=i&&(0<=e.getContentType().indexOf("image")||-1===e.getDuration()),n=this.isVpaidAd(e),r=i&&n&&this.options.vpaidcontrols,s=(this.currentAd=e,this.blockingInstreamPlayer&&this.blockingInstreamPlayer.setSkipOffset(e.getSkipTimeOffset()),this.adsLoaderManager.bindEvents({COMPLETE:this.adComplete.bind(this)}),n&&this.env.OS.mobile&&this.options.autoplayadsmuted&&this.adsLoaderManager.bindEvents({VOLUME_CHANGED:function(){t.adsLoaderManager.unbindEvents(["VOLUME_CHANGED"]),t.player.setMute(0===t.adsLoaderManager.adsManager.getVolume())}}),i||this.trigger("stopBlocking",{isNonlinear:!0}),this.utils.toggleClass(this.player.getContainer(),C,i&&(s||n)),this.utils.toggleClass(this.player.getContainer(),R,r),this.resize(),this.muteInstreamProvider(),clearTimeout(this.timeoutAdStart),this.adsLoaderManager.adsManager),n=(this.progressInterval(e,s),J(this.playlistItemManager,e,this.scheduledAd)),r=void 0===n.podcount||1===n.sequence;"pre"===n.adposition&&r&&(this._qoe.tick("adImpression"),n.timeLoading=this._qoe.between("adBeforePlay","adImpression")),i&&!r&&this.trigger(I,n),this.trigger("adImpression",n,e),this.setupViewableListener(),this.setState(e,a,"buffering")},E.progressInterval=function(r,a){var o,d,l,u,h,c,g,p,m,f=this;clearInterval(this.progressIntervalId),a&&(o=r.getAdId(),d=r.isSkippable()&&this.customSkipButton,l=-1,u=this.options.admessage||"",h=this.options.podmessage||"",c=this.options.skipmessage||"",g=this.options.skiptext||"",p=new RegExp("__AD_POD_CURRENT__","g"),m=new RegExp("__AD_POD_LENGTH__","g"),this.progressIntervalId=setInterval(function(){var e,t,i,s,n;f.currentAd&&f.currentAd.getAdId()===o?(t=a.getRemainingTime(),isNaN(t)||t<=0||l===t||(l=t,t=(e=f.currentAd.getDuration())-t,n=Math.round(e-t),d&&(0<(s=f.timeTillSkip=Math.ceil(r.getSkipTimeOffset()-t))?(f.customSkipButton.innerText=c.replace(/(\b)xx(s?\b)/g,"$1"+s+"$2"),f.customSkipButton.style.cursor="default"):(f.customSkipButton.innerText=g,f.customSkipButton.style.cursor="pointer")),f.blockingInstreamPlayer&&(s=u.replace(/(\b)xx(s?\b)/g,"$1"+n+"$2"),(n=y(f.currentAd,"getAdPodInfo"))&&1<(i=y(n,"getTotalAds"))&&(n=y(n,"getAdPosition"),s=h.replace(p,n).replace(m,i)+"  "+s),f.blockingInstreamPlayer.setText(s),f.customCountDownDiv&&(f.customCountDownDiv.innerText=s),f.instreamProvider.trigger("time",{duration:e,position:t})),0<e&&((n=J(f.playlistItemManager,r,f.scheduledAd)).position=t,n.duration=e,f.adViewableImpressionHandler(n),f.trigger("adTime",n)))):clearInterval(f.progressIntervalId)},250))},E.setupViewableListener=function(){this.player.off(i,this.viewableHandler,this),this.player.on(i,this.viewableHandler,this),this.viewableHandler({viewable:this.player.getViewable()})},E.adViewableHandler=function(e){var e=e.position,t=(null===this.lastPosition&&(this.lastPosition=e),e-this.lastPosition);this.lastPosition=e,t=Math.min(Math.max(0,t),4),this.viewablePlayedTime+=t,2<=this.viewablePlayedTime&&(this.player.off(i,this.viewableHandler,this),this.adViewableImpressionHandler=v,e=J(this.playlistItemManager,this.currentAd,this.scheduledAd),this.trigger("adViewableImpression",e))},E.viewableHandler=function(e){e.viewable?(this.viewablePlayedTime=0,this.lastPosition=null,this.adViewableImpressionHandler=this.adViewableHandler):this.adViewableImpressionHandler=v},E.adComplete=function(e){e=e.getAd(),this.finishAd(),e=J(this.playlistItemManager,e,this.scheduledAd);this.trigger("adComplete",e),this.adsLoaderManager.unbindEvents(["VOLUME_CHANGED"])},E.adClick=function(e){var t=this.adsLoaderManager.adsManager,e=e.getAd(),t=(this.reason="clickthrough",this.isVpaidAd(e)||(this.debugConsoleLog("[JW DEBUG] Ad paused due to ad click"),t.pause()),J(this.playlistItemManager,e,this.scheduledAd));this.trigger("adClick",t)},E.adPaused=function(e){this.paused||(this.paused=!0,e=e.getAd(),null===this.reason&&this.isVpaidAd(e)&&(this.reason=S),this.setState(e,"paused"))},E.adResumed=function(e){this.paused&&(this.paused=!1,e=e.getAd(),null===this.reason&&this.isVpaidAd(e)&&(this.reason=S),this.setState(e,a))},E.adSkipped=function(e){e=e.getAd(),this.debugConsoleLog("[JW DEBUG] AdSkipped"),this.adsLoaderManager.unbindEvents(["COMPLETE","VOLUME_CHANGED"]),this.finishAd(),e=J(this.playlistItemManager,e,this.scheduledAd);this.trigger("adSkipped",e)},E.adUserClose=function(e){this.debugConsoleLog("[JW DEBUG] AdUserClose"),this.currentAd&&this.currentAd.isLinear()&&-1===this.currentAd.getDuration()?this.adSkipped(e):(this.adsLoaderManager.unbindEvents(["COMPLETE","VOLUME_CHANGED"]),this.finishAd())},E.allAdsCompleted=function(){this.resumeRequested(),this.stopAdsManager(),this.trigger("allAdsComplete",{})},E.stopAdsManager=function(){var t=this;this.initAdsManagerPromise.then(function(e){t.destroyed()||(t.debugConsoleLog("[JW DEBUG] Stop IMA SDK adsManager"),e.stop(),e.destroy(),t.initAdsManagerPromise=null)}).catch(v)},E.adLog=function(e){this.debugConsoleLog("[JW DEBUG]",e.type,e);var t=y(e,"getAdData"),t=t&&t.adError;t&&402===t.getVastErrorCode()?this.handleAdError(t,e):t&&(e=y(e,"getAd"),this.trigger(q,je(this.playlistItemManager,t,e,this.scheduledAd,{jwpseg:this.adsLoaderManager.getJwpSeg(e)})))},E.adError=function(e){var t=e.getError();this.handleAdError(t,e)},E.asyncError=function(e){var t,i=this;this.destroyed()||(clearTimeout(this.timeoutAdStart),this.timeoutAdStart=setTimeout(function(){return i.destroy()},0),e&&e.getError?(t=e.getError(),this.handleAdError(t,e,!0)):e.target&&e.target.src?console.error("Failed to load "+e.target.src):console.error(e))},E.getAdErrorEventObject=function(e,t){t=y(t,"getUserRequestContext"),t=t?t.offset:void 0;return je(this.playlistItemManager,e,null,this.scheduledAd,{offset:t})},E.handleAdError=function(e,t,i){var s=this,t=(this.options.debug&&console.error(e),this.getAdErrorEventObject(e,t));this.player&&0===this.player.getPosition()&&(this._qoe.tick("adError"),t.timeLoading=this._qoe.between("adBeforePlay","adError")),this.trigger(q,t),this.destroyed()||(900===e.getErrorCode()||i?(clearTimeout(this.timeoutAdStart),this.timeoutAdStart=setTimeout(function(){return s.destroy()},0)):this.destroy())},E.isVpaidAd=function(e){e=e.getContentType();return"application/javascript"===e||"application/x-shockwave-flash"===e},E.destroy=function(){this.debugConsoleLog("[JW DEBUG] JW Player destroy AdsPlayer"),this.trigger("stopBlocking",{isDestroyed:!0}),this.off(),this.destroyed()||(this.player.off(null,null,this),clearTimeout(this.timeoutAdStart),clearInterval(this.progressIntervalId),this.currentAd=null,this.options=null,this.adsLoaderManager.reset(null,!0),this.view.adTakeDown(),this.video=null,this.initAdsManagerPromise=null,this.instreamProvider.off(),this.instreamProvider.setProxy(null),this.instreamProvider=null,this.view=null,this.player=null)},E.destroyed=function(){return!this.player};var A,Oe=We,qe=(E=A=t,(t=Qe).prototype=Object.create(E.prototype),Te(t.prototype.constructor=t,E),(t=Qe.prototype).checkPreroll=function(e){this.adsLoaderManager.initializeDisplay({restrict:!0}),this.reason=e&&e.playReason?e.playReason:n,A.prototype.checkPreroll.call(this,e)},t.checkPostrolls=function(e){this.schedule.isVMAP()&&this.adsPlayer?this.adsPlayer.beforeComplete():A.prototype.checkPostrolls.call(this,e)},t.createAdsPlayer=function(i){var s=this;this.adsPlayer&&!this.adsPlayer.destroyed()||(this.adsPlayer=new Oe(this,this.reason),this.adsPlayer.on("all",function(e,t){return"allAdsComplete"===e?(s.adsPlayer.destroy(),void(s.adsPlayer=null)):"stopBlocking"===e?(s.stopBlocking(t&&t.isNonlinear),void(!i&&t&&t.isDestroyed&&(s.adsPlayer=null))):void("adError"!==e?(s.dequeueAdEvents(),s.trigger(e,t)):s.enqueueAdEvent(e,t,{preload:i}))}))},t.initAdsPlayer=function(e,t,i){var s=this;return e===k&&(this.reason=n),this.createAdsPlayer(i._preload),this.player.on("resize",function(){return s.adsPlayer.resize()},this.adsPlayer).on("fullscreen",function(){return s.adsPlayer.resize()},this.adsPlayer),this.adsPlayer.init(e,t,i).then(function(e){s.trigger("adsManager",{adsManager:e,videoElement:s.video})})},t.adLoadRequest=function(e,t){var i=this,s=this.utils.extend({},this.config),s=(s.ad=e,this.offset=e.offset||this.offset,s.adPosition=De(this.player),new _e(s,this.utils)),n=this.initAdsPlayer(t?_:k,s,e);return X().then(function(){return i.adsPlayer.requestAds(),n})},t.dequeueAdEvents=function(){var i=this;this._events.forEach(function(e){var t=e.type,e=e.event;i.trigger(t,e)}),this._events.splice(0)},t.triggerAdBreakEvents=function(e,t){var i=this,t=(e._position=e._position||t,this.blockingInstreamPlayer.once("destroyed",function(){i.dequeueAdEvents(),i.trigger("adBreakEnd",J(i,null,e))}),J(this,null,e));this.trigger("adBreakStart",t),this.dequeueAdEvents(),this.adsPlayer&&this.adsPlayer.destroyed()&&this.stopBlocking()},t.exitFullscreenOnInlineIOS=function(){var e;!this.env.OS.iOS||this.env.Browser.version.major<10||((e=this.player.getContainer()).requestFullscreen||e.webkitRequestFullscreen||(this.player.setFullscreen(!1),this.utils.style(this.fullscreenIcon,{display:"none"})))},t.startBlocking=function(e){this.blockingInstreamPlayer||this.destroyed()||(this.exitFullscreenOnInlineIOS(),this.qoe.tick("adLoading"),this.utils.addClass(this.player.getContainer(),M),this.blockingInstreamPlayer=this.player.createInstream().init(),e=e?"":this.options.loadingAd,this.blockingInstreamPlayer.setText(e),this.blockingInstreamPlayer.applyProviderListeners(this.instreamProvider),this.adsPlayer&&!this.adsPlayer.destroyed()&&(this.adsPlayer.blockingInstreamPlayer=this.blockingInstreamPlayer),this.view.adSetup())},t.stopBlocking=function(e){this.destroyed()||(this.player.off("viewable",null,this),this.utils.style(this.fullscreenIcon,{display:""}),this.utils.removeClass(this.player.getContainer(),[C,R,M]),this.blockingInstreamPlayer&&(this.instreamProvider.off(),this.blockingInstreamPlayer.destroy(),this.blockingInstreamPlayer=null),e||this.view.adTakeDown())},t.loadAd=function(e,t){if(e)return this.adsPlayer&&this.adsPlayer.scheduledAd!==e&&this.adsPlayer.destroy(),e._preload=!0,this.adLoadRequest(e,t)},t.playPreloadedPromise=function(e){var t=this;e.then(function(){return t.adsPlayer.startAdsLoader(t.blockingInstreamPlayer)}).catch(function(){t.stopBlocking()})},t.startAdBreak=function(e,t){var i=this;e&&(this.adsPlayer&&this.adsPlayer.scheduledAd!==e&&this.adsPlayer.destroy(),this.startBlocking(),this.dequeueAdEvents(),this.adLoadRequest(e,t).then(function(){i.adsPlayer.startAdsLoader(i.blockingInstreamPlayer)}).catch(function(){i.stopBlocking()}))},t.destroy=function(){this.stopBlocking();var e=this.adsLoaderManager;e&&(e.reset(),this.adsLoaderManager=null),this.adsPlayer&&this.adsPlayer.destroy(),this.adsPlayer=null,A.prototype.destroy.call(this)},t.destroyed=function(){return null===this.adsLoaderManager},Qe),Ue=((E=ze.prototype).getVpaidMode=function(e){var t=google.ima.ImaSdkSettings.VpaidMode;return"disabled"===e||"none"===e?t.DISABLED:"enabled"===e?t.ENABLED:t.INSECURE},E.initializeDisplay=function(e){this.adDisplayContainer&&!this.displayInitialized&&(this.adDisplayContainer.initialize(),e&&e.restrict&&(this.displayInitialized=!0))},E.contentComplete=function(){this.adsLoader&&this.adsLoader.contentComplete()},E.reset=function(e,t){var i=this;t?(this.adsRequest=null,this.userRequestContext=null,(t=this.adsManager)&&(t.destroy(),this.adsManager=null),this.adsManagerEvents={},Object.keys(this.adsLoaderEvents).forEach(function(e){i.adsLoader.removeEventListener(e,i.adsLoaderEvents[e])}),this.adsLoaderEvents={}):this.contentComplete(),e&&(this.schedule=null,this.breakMap={}),this.initialized=this.started=!1},E.prepare=function(e,t){var i=google.ima.settings,s=(i.setDisableCustomPlaybackForIOS10Plus(!0),t.locale||this.player.getConfig().language),s=(i.setLocale(s),t.ppid);return s&&i.setPpid(s),"enabled"===t.omidSupport&&i.setFeatureFlags({enableOmidBeta:!0}),0<=t.maxRedirects&&i.setNumRedirects(t.maxRedirects),null===this.adsLoader&&(this.adDisplayContainer=new google.ima.AdDisplayContainer(this.container,e),this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer)),this.adsLoader},E.open=function(e,t,i){var s=this,n=this.prepare(i,t);return new Promise(function(e,t){n.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,t,!1),n.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,e,!1),s.adsLoaderEvents[google.ima.AdErrorEvent.Type.AD_ERROR]=t,s.adsLoaderEvents[google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED]=e})},E.requestAds=function(e,t,i,s){var n,r,a,o,d,l,u,h;null===this.adsRequest&&s&&(l=this.player,n=this.adsRequest=new google.ima.AdsRequest,e=this.userRequestContext={requestType:e,vpaidMode:t.vpaidmode,playerVersion:l.version.split("+")[0],adPosition:t.adPosition},n.setAdWillAutoPlay(!1!==l.getConfig().autostart),n.setAdWillPlayMuted(l.getMute()),d=l.getSafeRegion(!1),n.linearAdSlotWidth=d.width,n.linearAdSlotHeight=d.height,d=l.getSafeRegion(!0),n.nonLinearAdSlotWidth=d.width,n.nonLinearAdSlotHeight=d.height,n.forceNonLinearFullSlot=i.forceNonLinearFullSlot,n.vastLoadTimeout=i.vastLoadTimeout,"enabled"===t.omidSupport&&(n.omidAccessModeRules=t.omidAccessModeRules),l=this.adsLoader.getSettings(),d=this.getVpaidMode(e.vpaidMode),l.setPlayerType("jwplayer"),l.setPlayerVersion(e.playerVersion),l.setVpaidMode(d),s._pod?n.adsResponse=e.adsResponse=(i=s._pod,r=s._offSet,a=document.implementation.createDocument("http://www.iab.net/videosuite/vmap","vmap:VMAP",null),(o=a.documentElement).setAttribute("version","1.0"),i.forEach(function(e){var t=a.createElement("vmap:AdTagURI"),e=(t.appendChild(a.createCDATASection(e)),o.appendChild(a.createElement("vmap:AdBreak"))),i=(r+"").replace("pre","start").replace("post","end"),i=(e.setAttribute("timeOffset",i),e.appendChild(a.createElement("vmap:AdSource")));i.setAttribute("allowMultipleAds","true"),i.setAttribute("followRedirects","true"),i.appendChild(t)}),o.outerHTML||(new XMLSerializer).serializeToString(o)):s.adm||s._adXML?n.adsResponse=e.adsResponse=s.adm||s._adXML:s.tag||s._adQueue&&1===s._adQueue.length?(t=s.tag||s._adQueue[0],n.adTagUrl=e.adTagUrl=t.trim()):(d=s._adQueue&&s._adQueue.length?(l=s._adQueue,u=document.implementation.createDocument("http://www.w3.org/2001/XMLSchema-instance","VAST",null),(h=u.documentElement).setAttribute("version","2.0"),l.forEach(function(e,t){var i=u.createElement("Ad"),s=(i.setAttribute("id",t),u.createElement("Wrapper")),n=u.createElement("Extensions"),r=u.createElement("Extension"),t=(r.setAttribute("type","waterfall"),r.setAttribute("fallback_index",t),u.createElement("VASTAdTagURI"));t.appendChild(u.createCDATASection(e)),i.appendChild(s),s.appendChild(t),s.appendChild(n),n.appendChild(r),h.appendChild(i)}),h.outerHTML||(new XMLSerializer).serializeToString(h)):s.xml,n.adsResponse=e.adsResponse=d),this.adsLoader.requestAds(n,e))},E.getAdsManager=function(e,t,i){var s=new google.ima.AdsRenderingSettings,n=(s.enablePreloading=i.enablePreloading||i.preloadAds,s.loadVideoTimeout=i.loadVideoTimeout,s.uiElements=null,s.useStyledNonLinearAds=!0,this.environment.OS.android&&this.environment.Browser.chrome&&84<=this.environment.Browser.version.major&&(s.mimeTypes=["video/mp4","video/webm"]),this.player.getConfig().bandwidthEstimate);return s.bitrate=n?n/1e3:-1,i.customUi&&i.customUi.disableUi&&(s.disableUi=!0),this.adsManager=e.getAdsManager(t,s),this.userRequestContext=e.getUserRequestContext(),this.adsManager},E.init=function(e,t,i){null!==this.adsManager&&!1===this.initialized&&(this.adsManager.init(e,t,i),this.initialized=!0)},E.start=function(){null!==this.adsManager&&!1===this.started&&(this.initializeDisplay({restrict:!0}),this.adsManager.start(),this.started=!0)},E.bindEvents=function(s){var n=this,r=google.ima.AdEvent.Type,a=google.ima.AdErrorEvent.Type;Object.keys(s).forEach(function(e){var t=r[e]||a[e],i=n.adsManagerEvents[t];i&&n.adsManager.removeEventListener(t,i),n.adsManager.addEventListener(t,s[e],!1),n.adsManagerEvents[t]=s[e]})},E.unbindEvents=function(e){var i=this,s=google.ima.AdEvent.Type,n=google.ima.AdErrorEvent.Type;e.forEach(function(e){var e=s[e]||n[e],t=i.adsManagerEvents[e];t&&(i.adsManager.removeEventListener(e,t),delete i.adsManagerEvents[e])})},E.getTag=function(e){if("string"==typeof this.schedule)return this.schedule;e=y(e,"getAdPodInfo");if(e){e=this.breakMap[y(e,"getTimeOffset")]||{};if(e.tag)return e.tag}return this.userRequestContext?this.userRequestContext.adTagUrl||this.userRequestContext.adsResponse||"":(console.error("invalid request context",this.userRequestContext),"")},E.getJwpSeg=function(e){var e=y(e,"getAdPodInfo");return e?(e=y(e,"getTimeOffset"),this.breakMap[e]&&this.breakMap[e].jwpseg):null},E.getTimeoffsetFromPosition_=function(){var i,s=this.player.getPosition(),n=1/0;return Object.keys(this.breakMap).forEach(function(e){var t=s-e;0<=t&&t<n&&(i=e,n=t)}),n===1/0?-1:i},E.skipAd=function(){this.adsManager&&this.adsManager.skip()},E.getBid=function(e){e=Be(e,this.player.utils);return this.breakMap[e]?this.breakMap[e].bid:null},E.setBid=function(e,t){e=Be(e,this.player.utils);this.breakMap[e]=this.breakMap[e]||{},this.breakMap[e].bid=t},ze),Ve={},Ne={},He={};function ze(e,t){this.adsLoader=null,this.adDisplayContainer=null,this.displayInitialized=!1,this.initialized=!1,this.started=!1,this.adsRequest=null,this.userRequestContext=null,this.adsManager=null,this.adsLoaderEvents={},this.adsManagerEvents={},this.container=t,this.schedule=null,this.breakMap={},this.player=e,this.environment=e.getEnvironment()}function Qe(e,t,i,s,n,r,a,o,d,l){t=A.call(this,e,t,i,s,l)||this;return e.utils.extend(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t),e.Events),t.client=O,t.config=s,t.options=n,t.player=e,t.env=e.getEnvironment(),t.utils=e.utils,t.adsLoaderManager=o,t.view=a,t.qoe=new e.utils.Timer,t.instreamProvider=r,t.vmapPromise=Promise.resolve(),t.fullscreenIcon=e.getContainer().querySelector(".jw-icon-fullscreen"),t.video=d,t.hasPreroll=!0,t.reason=null,t}function We(e,t){var i=e.player,s=e.options,n=e.instreamProvider,r=e.view,a=e.adsLoaderManager,o=e.video,d=e.item,l=e.client;i.utils.extend(this,i.Events),this.playlistItemManager=e,this.player=i,this.options=s,this.instreamProvider=n,this.view=r,this.adsLoaderManager=a,this.video=o,this.item=d,this.client=l,this.reason=t,this.env=i.getEnvironment(),this.utils=i.utils,this._qoe=new i.utils.Timer,s.customUi&&(e=s.customUi,this.mainContainer=i.getContainer(),this.customUiDiv=document.getElementById(e.customUiDivId),this.adClickButton=document.getElementById(e.adClickButtonId),this.customCountDownDiv=document.getElementById(e.customCountDownId),this.customSkipButton=document.getElementById(e.customSkipButtonId),this.timeTillSkip=Number.POSITIVE_INFINITY),this.initAdsManagerPromise=null,this.blockingInstreamPlayer=null,this.currentAd=null,this.progressIntervalId=-1,this.viewablePlayedTime=0,this.lastPosition=null,this.adViewableImpressionHandler=v,this.paused=!1,this.playbackProxy={currentTime:this.player.getPosition(),duration:this.player.getDuration()},i.on("time",this.time,this),this.debugConsoleLog=v,s.debug&&(this.debugConsoleLog=function(){var e;(e=console).log.apply(e,arguments)})}function Ge(i,s){return Ve[s]||(Ve[s]=new Promise(function(e,t){new i.key(s);return t()}))}function Xe(){}var E;t=".jw-plugin-googima{overflow:hidden;width:100%;height:100%;display:block;visibility:hidden;pointer-events:none;opacity:0}.jw-plugin-googima.jw-ad-instream{visibility:visible;display:block;pointer-events:all;opacity:1}.jw-plugin-googima.jw-ad-instream .jw-ads-view>:not(div),.jw-plugin-googima.jw-ad-instream .jw-ads-view>div:not(:empty){width:100%;height:100%}.jw-plugin-googima.jw-ad-linear{top:0;left:0;bottom:0}.jw-plugin-googima.jw-ad-non-linear{top:auto}.jw-plugin-googima .jw-ads-view{position:absolute;width:100%;height:100%}.jwplayer.jw-flag-ads-googleima.jw-flag-touch .jw-controlbar{font-size:1em}.jwplayer.jw-flag-ads-googleima.jw-flag-touch .jw-display-icon-display,.jwplayer.jw-flag-ads-googleima.jw-flag-touch .jw-display-icon-display .jw-icon-display{pointer-events:none}.jwplayer.jw-flag-ads-googleima .jw-controlbar{background:0 0!important;pointer-events:none}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-icon{pointer-events:all}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-icon-fullscreen:not(.jw-fullscreen-ima){display:none}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-fullscreen-ima{display:flex}.jwplayer.jw-flag-ads-googleima .jw-controls-backdrop{display:none}.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume,.jwplayer.jw-flag-ads-googleima.jw-ie .jw-svg-icon{background:rgba(0,0,0,.25);border-radius:3px}.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume{margin:0 10px}@supports (filter:drop-shadow(0 0 3px #000)){.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume,.jwplayer.jw-flag-ads-googleima.jw-ie .jw-svg-icon{background:0 0;border-radius:0}.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume{margin:0}}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-svg-icon{fill:#fff;filter:drop-shadow(0 0 3px #000)}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-text{text-shadow:0 0 3px #000}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player.jw-flag-ads.jw-state-playing.jw-flag-touch:not(.jw-flag-ads-vpaid) .jw-controls .jw-controlbar{pointer-events:none}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-controlbar{flex-flow:column-reverse nowrap;height:100%;max-height:none}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-button-container{align-items:flex-end;flex-wrap:wrap;margin-bottom:7px}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-controlbar .jw-icon{height:30px}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-text{align-self:flex-start;margin:16px 0 0 16px;order:-1;width:100%}","undefined"!=typeof window&&((E=document.createElement("style")).setAttribute("media","screen"),E.innerHTML=t,document.head.appendChild(E)),(window.jwplayerPluginJsonp||window.jwplayer().registerPlugin)(O,"8.1",function(a,n,e){var t,i,s,r,o,d,l,u,h,c,g,p=this,m=new Pe(a,n,O),f=a.utils,y=a.getConfig(),v=new _e(n||{},f),A=m.getAdRules(),w=this,P=null,b=0,E=null,k=!1,_=!1,M=n.bids,C=(t=a,s=n,r=O,h=(i=y).key,c=t.utils,l=c,d=s,(g=He[u=h]||(He[u]=Ge(l,u).catch(function(){return{}}).then(function(e){var t,e=!0===d.outstream?(t=!1!==e.canPlayOutstreamAds,"Outstream Ad Limit Reached"):(t=!1!==e.canPlayAds,"Ad Limit Reached");if(!1===t)throw new Error(e);return{message:"Can Play Ads"}}))).catch(Xe),s.bids&&(l=c,(o=Ne[u=h]||(Ne[u]=Ge(l,u).catch(function(){return{}}).then(function(e){if(!1===e.canUseVPB)throw new Error("Not entitled for Player Bidding")}))).catch(Xe)),t.on("ready",function(){o&&o.catch(function(e){t.trigger("destroyBidding"),t.trigger(H,ve(e.message,60009,i,r))}),g.catch(function(e){t.trigger("destroyPlugin",e),t.trigger(H,ve(e.message,60002,i,r))})}),X(f).catch(f.noop),new Me(e,a.id,f)),R=new Ie(f,a.Events,C),I=new Ue(a,C.getAdDiv()),S=null;function T(e,t,i,s){try{return e.getCompanionAds(t,i,s)}catch(e){return[]}}function L(){j(),I&&I.adDisplayContainer&&I.adDisplayContainer.destroy(),a.off(null,null,this),a.playAd=f.noop,a.pauseAd=f.noop}function x(e){S&&S.adsPlayer&&S.adsPlayer.discardAdBreak(),I.contentComplete(),j(e),a.setCues([])}function B(e,t,i){var e=e.item||{},s=m.getSchedule(e,i.playlistItemEventCount),r=new qe(a,s,e,n,v,R,C,I,P,_);return r.on("all",function(e,t){"preloadNext"!==e?a.trigger(e,t):(e=U({},i,{preloadPreroll:!0,playlistItemEventCount:b+1}),r.next=B(t,0,e))},w),r.init(M,i),r.on(F,function(){return e=r.adsPlayer,t=e.currentAd,(i=new google.ima.CompanionAdSelectionSettings).sizeCriteria=google.ima.CompanionAdSelectionSettings.SizeCriteria.IGNORE,s=v.companiondiv||{width:300,height:250},(n=(s=function(e){for(var t=[],i=0;i<e.length;i++){var s=e[i];t.push({width:s.getWidth(),height:s.getHeight(),type:"html",resource:s.getContent()})}return t}(T(t,s.width,s.height,i))).length)&&((e=J(S,t,e.scheduledAd)).companions=s,a.trigger("adCompanions",e)),v.companiondiv&&(i=new google.ima.CompanionAdSelectionSettings,v.companionResourceType&&(i.resourceType=google.ima.CompanionAdSelectionSettings.ResourceType[v.companionResourceType]),s=T(t,v.companiondiv.width,v.companiondiv.height,i),n=Math.max(n,s.length),(e=s)&&e.length&&(t=document.getElementById(v.companiondiv.id))&&(e=e[0])&&("function"==typeof e.getContent?t.innerHTML=e.getContent():t.innerHTML=e.resource||e.content)),0<n;var e,t,i,s,n}),r}function j(e){S&&(e&&(E=S.next,k=S.nextPlaylistRelated),S.off(null,null,w),S.destroy(),S=null),m.reset(),a.setCues([])}this.version="8.10.0",a.utils.extend(this,a.Events),a.pauseAd=function(e,t){S&&S.adsPlayer&&(e?S.adsPlayer.pause(t||{}):S.adsPlayer.resume(t||{}))},a.playAd=function(e){var t=f.extend({},n),e=a._.isArray(e)?e.slice(0):[e],t=new _e(t,f),i=(t.setLocalizationOptions(y.localization.advertising),S?S.blockingInstreamPlayer:null);i&&(i.noResume=!0),j(),(S=B({item:a.getPlaylistItem()},0,t))&&!S.destroyed()&&S.startAdBreak({_adQueue:e,_position:De(a),adBreakId:f.genId(12)})},a.skipAd=function(){I&&I.skipAd()},a.on("ready",function(){y.localization=a.getConfig().localization,v.setLocalizationOptions(y.localization.advertising),P=P||a.createInstream().getMediaElement(),X(f).catch(function(e){e.message.match(/Failed to load/)&&D("Ad playback blocked by an ad blocker",2e4)});function e(){t.removeEventListener("mouseup",e),t.removeEventListener("touchend",e),I.initializeDisplay()}var t=document.body;t.addEventListener("mouseup",e,!1),t.addEventListener("touchend",e,!1)},this).on("playlistItem",function(e){var t;!function(e,t){X(f).then(function(){I.prepare(P,t)});var i=e.item||a.getPlaylistItem(e.index),s=(x(!0),m.getSchedule(i,b));A.rulesAllowAdPlayback(b)&&s&&(s.getAllAds().length||s.isVMAP())&&(E&&i!==E.item&&!1===k&&(E.off(null,null,this),E.destroy(),E=null),I.reset(!0),(S=E||B(e,0,t)).attachListeners(),E=null,k=!1)}(e,U({playlistItemEventCount:++b},v)),S&&!S.schedule.isVMAP()&&(e=S.schedule.getMidRolls(),t=[],e.length&&e.forEach(function(e){"nonlinear"!==e._type&&t.push({begin:e._offSet,text:v.cuetext,cueType:"ads"})}),a.addCues(t))},this).on("playlistComplete",function(){x(!0)},this).on("cast",function(e){_=!!e.active,e.active&&x()},this).on("mute",function(e){e=e.mute;R.mute(e)},this).on("destroyPlugin",function(){p.destroy()},this).on("destroyBidding",function(){M=null}).on("remove",L,this);var D=function(e,t){L(),a.trigger(q,je(null,{message:e,adErrorCode:t,id:"-1",placement:xe(y),tag:""}))};this.destroy=j,this.adsDebugMode=function(){v.debug=!0,S&&(S.debugConsoleLog=function(){var e;(e=console).log.apply(e,arguments)})}})}();
