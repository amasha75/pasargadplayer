!function(){"use strict";var g="dai",p="-1",r="adBreakEnd",f="adError",n="time",s="meta",i="jw-flag-ads jw-flag-ads-dai",o="playing";function y(){return(y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i,a=arguments[e];for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t}).apply(this,arguments)}var l={adTagParameters:{},apiKey:"",assetKey:"",cmsID:"",locale:"",debug:!1,liveAdMessage:"Playing Ad",requestTimeout:3e3,videoID:""},v=(t.prototype.setLocalizationOptions=function(t){var e=t.loadingAd,i=t.admessage,a=t.podmessage,t=t.cuetext;this.loadingMessage=e,this.admessage=i,this.adcounterdynamic=a,this.cuetext=t},t);function t(t,e){for(var i in l)if(l.hasOwnProperty(i)){var a=t[i],s=l[i],r=typeof s;if(void 0!==a){if(typeof(a="boolean"!=r&&"number"!=r?a:function(t){if("true"===t)return!0;if("false"===t)return!1;var e=parseFloat(t);return isNaN(e)?t:e}(a))!=r)throw new Error("invalid parameter: "+i+" should be a "+r);this[i]=a}else this[i]=s}this.setLocalizationOptions(e)}var a=null;function A(t){if(a)return a;if(window.google&&google.ima&&google.ima.dai)return a=Promise.resolve();var e=["//","imasdk.googleapis.com/js/sdkloader/ima3_dai.js"],t=("file:"===document.location.protocol&&e.unshift("https:"),new t.scriptloader(e.join("")));return a=t.load().then(function(){})}var w={},E={},d=((u=e.prototype).getAdBreakId_=function(t){return _("b"+(h(t)||t.getAdId()),this.adBreakIds_)},u.getAdPlayId_=function(t){return _("b"+h(t)+"a"+t.getAdId(),this.adIds_)},u.adEventObject=function(t){var t=t||this.currentAd_,e={client:g,viewable:this.player_.getViewable()};if(!t)return e;this.currentAd_=t,e.id=this.getAdBreakId_(t),e.adPlayId=this.getAdPlayId_(t),e.adtitle=t.getTitle(),e.adsystem=t.getAdSystem(),e.creativetype="application/x-mpegURL",e.linear="linear";var i,t=t.getAdPodInfo();return t&&(1<(i=t.getTotalAds())&&(e.sequence=t.getAdPosition(),e.podcount=i),e.adposition=0===(i=t.getTimeOffset())?"pre":-1===i?"post":"mid"),e},u.clearAd=function(){this.currentAd_=null},e);function e(t){this.player_=t,this.adBreakIds_={},this.adIds_={},this.currentAd_=null}function _(t,e){var i;return t?((i=e[t])||(e[t]=i=new Array(13).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,12)),i):p}function h(t){t=t.getAdPodInfo();return t?(""+t.getTimeOffset()).replace(/[-.]/g,"N"):null}(u=m.prototype).beforePlay=function(){var t=this;this.instream_||this.destroyed_()||(clearTimeout(this.timeoutAdStart_),this.timeoutAdStart_=setTimeout(function(){t.destroyed_()||t.destroy()},this.options_.requestTimeout),this.video_=this.player_.getConfig().mediaElement,this.instream_=this.player_.createInstream().init().setText(this.options_.loadingMessage),this.init_().catch(function(){t.stopBlocking_()}))},u.pause=function(){this.video_&&this.video_.pause()},u.resume=function(){this.video_&&this.video_.play()},u.stopBlocking_=function(){this.destroyed_()||(clearTimeout(this.timeoutAdStart_),this.destroyBlockingInstreamPlayer_())},u.init_=function(){var a=this;return A().then(function(){if(a.destroyed_())return null;var t,e=google.ima.dai.api.StreamEvent.Type,i=new google.ima.dai.api.UiSettings;if(i.setLocale(a.options_.locale||a.player_.getConfig().language),a.streamManager_=new google.ima.dai.api.StreamManager(a.video_,a.adUiElement_,i),a.streamManagerEvents_=[e.CUEPOINTS_CHANGED,e.LOADED,e.AD_BREAK_STARTED,e.AD_BREAK_ENDED,e.STARTED,e.AD_PROGRESS,e.CLICK,e.COMPLETE,e.ERROR],a.streamManager_.addEventListener(a.streamManagerEvents_,a.streamEventHandler_,!1),a.isVOD_)(t=new google.ima.dai.api.VODStreamRequest).contentSourceId=a.options_.cmsID,t.videoId=a.options_.videoID;else{if(!a.liveMode_)throw new Error("Invalid options");(t=new google.ima.dai.api.LiveStreamRequest).assetKey=a.options_.assetKey,a.player_.off(s,a.handleMeta_,a),a.player_.on(s,a.handleMeta_,a)}t.apiKey=a.options_.apiKey,t.adTagParameters=a.options_.adTagParameters,a.streamManager_.requestStream(t)})},u.loadStream_=function(t){var e=this.player_.getPlaylistItem(this.player_.getPlaylistIndex()),t=t.url;e.sources=[y(e.sources[0],{file:t})],this.instream_&&(this.instream_.replacePlaylistItem(e),this.stopBlocking_())},u.onStreamEvent_=function(t){var e=this,i=google.ima.dai.api.StreamEvent.Type,a=this.daiUtils_.adEventObject(t.getAd());switch(t.type){case i.CUEPOINTS_CHANGED:var s=this.adCues_=t.getStreamData().cuepoints;s&&s.length&&(s=s.filter(function(t){return 0<t.start}).map(function(t){return{begin:t.start,text:e.options_.cuetext}}),this.player_.setCues(s),this.player_.on(n,this.checkMidrolls_,this));break;case i.LOADED:clearTimeout(this.timeoutAdStart_),this.loadStream_(t.getStreamData());break;case i.AD_BREAK_STARTED:this.player_.getState()!==o&&this.player_.play(),this.player_.trigger("adBreakStart",a),this.setAdsMode_(!0),this.instream_.once("destroyed",function(){e.instream_=null,e.player_.trigger(r,a),e.daiUtils_.clearAd()});break;case i.AD_BREAK_ENDED:this.instream_.off().once("destroyed",function(){e.instream_=null,e.player_.trigger(r,a),e.daiUtils_.clearAd()}),this.setAdsMode_(!1);break;case i.STARTED:this.player_.trigger("adImpression",a);s=this.daiUtils_.adEventObject(null);s.newstate=o,this.instream_.setState(s);break;case i.AD_PROGRESS:if(!this.instream_)return;this.handleTime_(t.getStreamData().adProgressData,a);break;case i.CLICK:this.player_.trigger("adClick",a),this.player_.pause();break;case i.COMPLETE:this.player_.trigger("adComplete",a),this.daiUtils_.clearAd();break;case i.ERROR:s=t.getStreamData().errorMessage,s=y({id:p,message:"Ad Error: "+s},a);this.player_.trigger(f,s),this.daiUtils_.clearAd()}},u.checkMidrolls_=function(t){if(this.adCues_.length){for(var e=t.position,i=-1,a=0;a<this.adCues_.length&&!(this.adCues_[a].start>e);a++)i=a;-1<i&&!this.adCues_[i].played&&e!==this.adCues_[i].start&&(this.playerPositionBeforeMidroll_=e,this.player_.seek(this.adCues_[i].start))}},u.handleMeta_=function(t){t=t.metadata;this.streamManager_&&t&&this.streamManager_.onTimedMetadata(t)},u.setAdsMode_=function(t){var e=this;this.player_.off(n,this.checkMidrolls_,this),t?(this.utils_.addClass(this.playerContainer_,i),this.instream_||(this.instream_=this.player_.createInstream()),this.instream_.enableAdsMode(),this.liveMode_&&this.instream_.setText(this.options_.liveAdMessage),this.instream_.off(null,null,this).on("state",function(t){e.instream_.setState(t)},this),this.liveMode_&&(this.instream_.on(s,this.handleMeta_,this),this.handleMeta_({metadata:this.player_.getItemMeta()}))):(this.utils_.removeClass(this.playerContainer_,i),this.isVOD_&&this.player_.on(n,this.checkMidrolls_,this),this.destroyBlockingInstreamPlayer_(),this.playerPositionBeforeMidroll_&&(this.video_.currentTime=this.playerPositionBeforeMidroll_,this.playerPositionBeforeMidroll_=null))},u.handleTime_=function(t,e){var i,a,s=t.currentTime,r=t.duration;e.position=s,e.duration=r,this.instream_.setTime(e),this.isVOD_&&(e=t.adPosition,t=t.totalAds,a=this.options_.admessage||"",i=this.options_.adcounterdynamic||"",a=a.replace(/xx/gi,""+Math.ceil(r-s)),1<t&&(a=(i=(i=i.replace(/__AD_POD_CURRENT__/g,""+e)).replace(/__AD_POD_LENGTH__/g,""+t))+" "+a),this.instream_.setText(a))},u.destroyBlockingInstreamPlayer_=function(){this.instream_&&(this.instream_.destroy(),this.instream_=null)},u.destroy=function(){clearTimeout(this.timeoutAdStart_),this.destroyed_()||(this.player_.off(null,null,this),this.streamManager_&&(this.streamManager_.removeEventListener(this.streamManagerEvents_,this.streamEventHandler_,!1),this.streamManager_.reset()),this.stopBlocking_(),this.options_=null,this.video_=null,this.player_=null,this.item_=null,this.streamManager_=null)},u.destroyed_=function(){return!this.item_};var u,c,M=m;function m(t,e,i,a){var s=this;this.item_=t,this.options_=e,this.player_=i,this.daiUtils_=new d(i),this.adCues_=[],this.utils_=i.utils,this.playerContainer_=i.getContainer(),this.playerPositionBeforeMidroll_=null,this.instream_=null,this.timeoutAdStart_=-1,this.isVOD_=e.cmsID&&e.videoID,this.liveMode_=!this.isVOD_&&e.assetKey,this.video_=null,this.streamManager_=null,this.streamManagerEvents_=null,this.streamEventHandler_=function(t){s.onStreamEvent_(t)},this.adUiElement_=a,this.utils_.addClass(a,"jw-plugin-dai")}u=".jw-plugin-dai{top:0;left:0;bottom:0}.jwplayer.jw-flag-ads-dai .jw-plugin-dai{width:100%;height:100%}.jwplayer.jw-flag-ads-dai .jw-controlbar{background:0 0!important;pointer-events:none}.jwplayer.jw-flag-ads-dai .jw-controlbar .jw-icon{pointer-events:all}.jwplayer.jw-flag-ads-dai .jw-controlbar .jw-icon-fullscreen:not(.jw-fullscreen-ima){display:none}.jwplayer.jw-flag-ads-dai .jw-controlbar .jw-fullscreen-ima{display:flex}","undefined"!=typeof window&&((c=document.createElement("style")).setAttribute("media","screen"),c.innerHTML=u,document.head.appendChild(c)),(window.jwplayerPluginJsonp||window.jwplayer().registerPlugin)(g,"8.0",function(i,t,a){var s,e=i.utils,r=i.getConfig(),n=new v(t||{},r.localization.advertising),o=(A(e).catch(e.noop),r.key);function l(){s&&(s.destroy(),s=null)}this.version="0.5.4",y(this,i.Events),i.pauseAd=function(t){t="boolean"!=typeof t||t,s&&(t?s.pause():s.resume())},i.on("ready",function(){r.localization=i.getConfig().localization,n.setLocalizationOptions(r.localization.advertising),A(e).catch(function(){i.getAdBlock()&&m("Ad playback blocked by an ad blocker",2e4)}),c.catch(function(t){m("Ad Error: "+t.message,60002)})},this).on("playlistItem",function(t){l();var t=t.item,e=y({},n,t.daiSetting);(e.cmsID&&e.videoID||e.assetKey)&&(t.preload="none",s=new M(t,e,i,a),i.once("beforePlay",s.beforePlay,s))},this).on("destroyPlugin",l,this);d=e,_=t;var d,_,h,u,c=E[t=o]||(E[t]=(h=d,(w[u=t]||(w[u]=new Promise(function(t,e){new h.key(u);return e()}))).catch(function(){return{}}).then(function(t){var e,t=!0===_.outstream?(e=!1!==t.canPlayOutstreamAds,"Outstream Ad Limit Reached"):(e=!1!==t.canPlayAds,"Ad Limit Reached");if(!1===e)throw new Error(t);return{message:"Can Play Ads"}})));function m(t,e){l(),i.off(null,null,this),i.trigger(f,{id:p,client:g,message:t,code:900,adErrorCode:e,tag:""})}c.catch(e.noop),this.destroy=l})}();
